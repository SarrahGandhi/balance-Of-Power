<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Balance of Power</title>
  <link rel="stylesheet" href="./css/styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Oswald:wght@600&family=Playfair+Display:ital@1&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Baskervville+SC&display=swap" rel="stylesheet">



</head>
<body>
    <header class="nav">
        <div class="hamburger">
            <div></div>
            <div></div>
            <div></div>
        </div>
        <nav>
            <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#instructions">Instructions</a></li>
            <li><a href="solve.html">Solve</a></li>
            </ul>
        </nav>
    </header>
  <main class="chapter-sort-page">
    <h1 class="title">BALANCE OF POWER</h1>

    <div class="chapter-container" id="chapterContainer">
      <div class="chapter" draggable="true" data-id="1">
        <img src="images/chap_1.png" alt="Chapter 1">
      </div>
      <div class="chapter" draggable="true" data-id="2">
        <img src="images/chap_2.png" alt="Chapter 2">
      </div>
      <div class="chapter" draggable="true" data-id="3">
        <img src="images/chap_3.png" alt="Chapter 3">
      </div>
    </div>

    <button class="submit-btn" id="submitOrder">SUBMIT</button>
</main>

<div id="wrongOrderPopup" class="popup-overlay">
    <div class="popup-box">
      <p>
        <strong>Your timeline doesn't align.</strong><br>
        Memories must fall into place â€” the truth only surfaces in the right order.<br>
        Re-evaluate the evidence, and try again.
      </p>
      <button id="closeWrongOrderPopup">CLOSE</button>
    </div>
  </div>
  <script>
    const container = document.getElementById('chapterContainer');
    const wrongPopup = document.getElementById('wrongOrderPopup');
    const closeWrongPopup = document.getElementById('closeWrongOrderPopup');
  
    let draggedItem = null;
  
    container.addEventListener('dragstart', (e) => {
      draggedItem = e.target.closest('.chapter');
      draggedItem.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
    });
  
    container.addEventListener('dragend', () => {
      if (draggedItem) {
        draggedItem.classList.remove('dragging');
        draggedItem = null;
      }
    });
  
    container.addEventListener('dragover', (e) => {
      e.preventDefault();
      const afterElement = getDragAfterElement(container, e.clientX);
      const current = document.querySelector('.dragging');
      if (afterElement == null) {
        container.appendChild(current);
      } else {
        container.insertBefore(current, afterElement);
      }
    });
  
    function getDragAfterElement(container, x) {
      const elements = [...container.querySelectorAll('.chapter:not(.dragging)')];
      return elements.reduce((closest, child) => {
        const box = child.getBoundingClientRect();
        const offset = x - box.left - box.width / 2;
        if (offset < 0 && offset > closest.offset) {
          return { offset, element: child };
        } else {
          return closest;
        }
      }, { offset: Number.NEGATIVE_INFINITY }).element;
    }
  
    document.getElementById('submitOrder').addEventListener('click', () => {
      const currentOrder = Array.from(container.querySelectorAll('.chapter')).map(el => el.dataset.id);
      const correctOrder = ['3', '1', '2'];
  
      if (JSON.stringify(currentOrder) === JSON.stringify(correctOrder)) {
        alert("You have matched all the chapters correctly!");
      } else {
        wrongPopup.style.display = "flex";
      }
    });
  
    closeWrongPopup.addEventListener('click', () => {
      wrongPopup.style.display = "none";
    });
  </script>
  
</body>
</html>
